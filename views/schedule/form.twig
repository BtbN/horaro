{% extends "layout.twig" %}

{% block content %}
<ul class="breadcrumb" style="margin-bottom: 5px;">
	<li><a href="/-/home">Home</a></li>
	<li><a href="/-/events/{{ event.id }}">{{ event.name }}</a></li>
	{% if schedule %}
	<li><a href="/-/events/{{ event.id }}/schedules/{{ schedule.id }}">{{ schedule.name }}</a></li>
	<li>Update Schedule&hellip;</li>
	{% else %}
	<li>New Schedule&hellip;</li>
	{% endif %}
</ul>

<div class="row">
	<div class="col-lg-12 col-md-12">
		<h1>{% if schedule %}Update Schedule{% else %}Create a New Schedule{% endif %}</h1>
	</div>
</div>

<div class="row">
	<div class="col-lg-6 col-md-6 col-sm-7">
		<div class="well">
			{% if schedule %}
			<form method="post" action="/-/events/{{ event.id }}/schedules/{{ schedule.id }}" class="form-horizontal">
				<div><input type="hidden" id="_method" name="_method" value="PUT" /></div>
			{% else %}
			<form method="post" action="/-/events/{{ event.id }}/schedules" class="form-horizontal">
			{% endif %}
				<fieldset>
					<legend>Schedule Information</legend>

					<div class="form-group{% if result and result.name.errors %} has-error{% endif %}">
						<label class="col-lg-3 control-label" for="name">Belongs to:</label>
						<div class="col-lg-9">
							<p class="form-control-static">{{ event.name }}</p>
						</div>
					</div>

					<div class="form-group{% if result and result.name.errors %} has-error{% endif %}">
						<label class="col-lg-3 control-label" for="name">Name:</label>
						<div class="col-lg-9">
							<input type="text" class="form-control" id="name" name="name" autofocus required placeholder="Main Schedule" value="{% if result %}{{ result.name.filtered }}{% elseif schedule %}{{ schedule.name }}{% endif %}">
							{% if result and result.name.errors and result.name.messages %}
							<span class="help-block"><strong>
								{% for message in result.name.messages %}
									{{ message }}<br>
								{% endfor %}
							</strong></span>
							{% endif %}
						</div>
					</div>

					<div class="form-group{% if result and result.slug.errors %} has-error{% endif %}">
						<label class="col-lg-3 control-label" for="slug">Slug:</label>
						<div class="col-lg-9">
							<div class="input-group">
								<div class="input-group-addon">/{{ event.slug }}/</div>
								<input type="text" class="form-control" id="slug" name="slug" required placeholder="schedule" pattern="[a-z0-9-]{2,}" value="{% if result %}{{ result.slug.filtered }}{% elseif schedule %}{{ schedule.slug }}{% endif %}">
							</div>
							{% if result and result.slug.errors and result.slug.messages %}
							<span class="help-block"><strong>
								{% for message in result.slug.messages %}
									{{ message }}<br>
								{% endfor %}
							</strong></span>
							{% endif %}
						</div>
					</div>

					<div class="form-group{% if result and result.timezone.errors %} has-error{% endif %}">
						<label class="col-lg-3 control-label" for="timezone">Timezone:</label>
						<div class="col-lg-9">
							<select name="timezone" id="timezone" class="form-control">
							{% for timezone in timezones %}
								<option>{{ timezone }}</option>
							{% endfor %}
							</select>
							{% if result and result.timezone.errors and result.timezone.messages %}
							<span class="help-block"><strong>
								{% for message in result.timezone.messages %}
									{{ message }}<br>
								{% endfor %}
							</strong></span>
							{% endif %}
						</div>
					</div>

					<div class="form-group{% if result and result.start.errors %} has-error{% endif %}">
						<label class="col-lg-3 control-label" for="start_date">Start:</label>
						<div class="col-lg-9">
							<div class="row">
  								<div class="col-lg-7">
									<input type="text" class="form-control" id="start_date" name="start_date" required placeholder="(click to edit)" value="{% if result %}{{ result.start_date.filtered }}{% elseif schedule %}{{ schedule.start|date('Y-m-d') }}{% endif %}">
								</div>

  								<div class="col-lg-5">
									<input type="text" class="form-control" id="start_time" name="start_time" required placeholder="(click to edit)" value="{% if result %}{{ result.start_time.filtered }}{% elseif schedule %}{{ schedule.start|date('H:i') }}{% endif %}">
								</div>
							</div>

							{% if result and result.start.errors and result.start.messages %}
							<span class="help-block"><strong>
								{% for message in result.start.messages %}
									{{ message }}<br>
								{% endfor %}
							</strong></span>
							{% endif %}
						</div>
					</div>

					<div class="form-group{% if result and result.twitch.errors %} has-error{% endif %}">
						<label class="col-lg-3 control-label" for="twitch">Twitch Stream:</label>
						<div class="col-lg-9">
							<div class="input-group">
								<div class="input-group-addon">http://twitch.tv/</div>
								<input type="text" class="form-control" id="twitch" name="twitch" placeholder="pongathon" value="{% if result %}{{ result.twitch.filtered }}{% elseif schedule %}{{ schedule.twitch }}{% endif %}">
							</div>
							{% if result and result.twitch.errors and result.twitch.messages %}
							<span class="help-block"><strong>
								{% for message in result.twitch.messages %}
									{{ message }}<br>
								{% endfor %}
							</strong></span>
							{% endif %}
						</div>
					</div>

					<div class="form-group">
						<div class="col-lg-12 text-center">
							<button type="submit" class="btn btn-primary"><i class="fa fa-check"> </i> {% if schedule %}Update{% else %}Create{% endif %} Schedule</button>
						</div>
					</div>
				</fieldset>
			</form>
		</div>
	</div>

	<div class="col-lg-6 col-md-6 col-sm-5">
	<legend>Test</legend>
		<p>Set the <strong>timezone</strong> to where the event is happening, so attendees can easily
		enter updated times without having to shift the times.</p>

		<p>The <strong>slug</strong> is used for the URLs to view the schedule and is appended to the
		slug of the event (i.e. <code>/eventslug/scheduleslug</code>). Use something alphanumeric and short,
		e.g. &quot;schedule&quot; if your event will only have one schedule. The slug has to be unique
		<em>within an event</em>, so each event can have a slug named <code>schedule</code>. A slug
		must be at least two characters long.</p>

		<p>If you leave the <strong>Twitch Stream</strong> empty, the team's stream will be used (if
		available).</p>
	</div>
</div>
{% endblock %}
