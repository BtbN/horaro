{% extends "layout.twig" %}

{% block title %}{{ schedule.name }} &ndash; {{ schedule.event.name }}{% endblock %}

{% block content %}
<ul class="breadcrumb" style="margin-bottom: 5px;">
	<li><a href="/-/home">Home</a></li>
	<li><a href="/-/events/{{ schedule.event.id }}">{{ schedule.event.name }}</a></li>
	<li>{{ schedule.name }}</li>
</ul>

<div class="row h-scheduler-header">
	<div class="col-lg-8 col-md-8 col-sm-8 col-xs-8">
		<h2>{{ schedule.name }} <a href="/-/schedules/{{ schedule.id }}/edit" class="btn btn-link btn-sm">Edit details&hellip;</a></h2>
	</div>

	<div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
		<a href="/-/schedules/{{ schedule.id }}/columns/edit" class="btn btn-link btn-sm pull-right"><i class="fa fa-columns"></i> Edit columns&hellip;</a>
	</div>
</div>

<div class="row">
	<div class="col-lg-12">
		<p class="text-center text-muted"><small>Click on an item to edit its details. Click and drag the handle on the left side to move items up or down.</small></p>
	</div>
</div>

<table class="table h-scheduler">
	<thead>
		<tr>
			<th class="h-handle">&nbsp;</th>
			<th class="h-scheduled">Scheduled</th>
			<th class="h-length">Estimated</th>
			{% for idx,column in schedule.columns.slice(0, 4) %}
			<th class="h-column {{ utils.scheduleColClass(idx) }}">{{ column.name }}</th>
			{% endfor %}
			<th class="h-controls">&nbsp;</th>
		</tr>
	</thead>

	<!-- ko foreach: items -->
	{% include 'schedule/item.twig' with {'schedule': schedule, 'items': schedule.items, 'columns': schedule.columns} %}
	<!-- /ko -->

	<!-- ko if: items().length === 0 -->
	<tbody>
		<tr>
			<td colspan="100" class="text-center active">
				Click on the button below to create the first row in this schedule.
			</td>
		</tr>
	</tbody>
	<!-- /ko -->
</table>

<!-- ko if: hasNewItem -->
<div class="row">
	<div class="col-lg-2 col-lg-offset-5 col-md-2 col-md-offset-5 col-sm-4 col-sm-offset-4 col-xs-4 col-xs-offset-4 text-center">
		<a href="#" class="btn btn-success btn-block btn-sm disabled"><i class="fa fa-plus fa-1x"></i> add row&hellip;</a>
	</div>
</div>
<!-- /ko -->

<!-- ko if: !hasNewItem() -->
<div class="row">
	<div class="col-lg-2 col-lg-offset-5 col-md-2 col-md-offset-5 col-sm-4 col-sm-offset-4 col-xs-4 col-xs-offset-4 text-center">
		<a data-bind="click: add" class="btn btn-success btn-block btn-sm"><i class="fa fa-plus fa-1x"></i> add row&hellip;</a>
	</div>
</div>
<!-- /ko -->

<script type="text/javascript">
var horaro = horaro||{};

horaro.ui = 'scheduler';
horaro.schedule = {
	id: {{ schedule.id }},
	columns: {{ columns|json_encode|raw }},
	name: 'Main Schedule',
	slug: 'main-schedule',
	timezone: 'UTC',
	start: new Date('2014-06-22T18:00:00Z'),
	items: {{ items|json_encode|raw }}
};
</script>
{% endblock %}
